[supervisord]
nodaemon=true
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid

[program:xvfb]
command=Xvfb %(ENV_DISPLAY)s -screen 0 %(ENV_SCREEN_WIDTH)sx%(ENV_SCREEN_HEIGHT)sx%(ENV_SCREEN_DEPTH)s -ac +extension GLX +render -noreset
user=node
autorestart=true
priority=10

[program:fluxbox]
command=fluxbox
environment=DISPLAY="%(ENV_DISPLAY)s"
user=node
autorestart=true
priority=20

[program:x11vnc]
command=x11vnc -display %(ENV_DISPLAY)s -forever -shared -nopw -rfbport %(ENV_VNC_PORT)s -xkb
user=node
autorestart=true
priority=30

[program:novnc]
command=websockify --web /usr/share/novnc %(ENV_NOVNC_PORT)s localhost:%(ENV_VNC_PORT)s
user=node
autorestart=true
priority=40

[program:playwright-mcp]
command=node /app/cli.js
    --browser chromium
    --no-sandbox
    --port %(ENV_MCP_PORT)s
    --host 0.0.0.0
    --allowed-hosts localhost:%(ENV_MCP_PORT)s,127.0.0.1:%(ENV_MCP_PORT)s
    --shared-browser-context
    --user-data-dir /home/node/.config/chromium
environment=DISPLAY="%(ENV_DISPLAY)s"
user=node
autorestart=true
priority=50
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
